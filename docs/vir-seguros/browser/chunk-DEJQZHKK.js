import{a as se,b as E}from"./chunk-BIVXLCIQ.js";import{a as ae,b as oe,c as A,d as N,e as V}from"./chunk-NQWGNM67.js";import"./chunk-F5PGA7PS.js";import{A as w,B as k,C as S,D,E as K,F as Q,G as U,H as X,I as Y,J as Z,N as ee,O as te,P as ne,Q as ie,R as re,z as M}from"./chunk-T5RHK3CC.js";import"./chunk-73VDZPOL.js";import"./chunk-XAZLOLJU.js";import{Gb as o,Hb as x,Ib as P,Jb as O,Kb as $,Lb as H,Nb as h,Qa as s,Qb as R,Ra as g,Rb as L,ca as v,gb as d,ha as _,ib as y,lc as z,mb as u,mc as J,nb as B,ob as G,pa as I,pb as W,qa as b,qb as t,rb as i,sb as f,tb as T,wb as l,yb as m}from"./chunk-PHZSOFUQ.js";function ve(r,p){r&1&&(t(0,"div",5)(1,"label",17),o(2,"C\xF3digo seguro"),i(),f(3,"input",18),i())}function Ie(r,p){if(r&1&&(t(0,"span",8),o(1),i()),r&2){let e=m();s(),x(e.showFormAlertMessage("insuranceName"))}}function be(r,p){if(r&1&&(t(0,"span",8),o(1),i()),r&2){let e=m();s(),x(e.showFormAlertMessage("sumInsured"))}}function Se(r,p){if(r&1&&(t(0,"span",8),o(1),i()),r&2){let e=m();s(),x(e.showFormAlertMessage("insuranceCost"))}}function ye(r,p){r&1&&(t(0,"button",15)(1,"mat-icon",19),o(2," save "),i(),t(3,"span"),o(4," Guardar "),i()())}var j=(()=>{class r{constructor(e,a,n){this.fb=e,this.insuranceService=a,this.alertService=n,this.data=v(oe),this.dialogRef=v(ae)}ngOnInit(){this.insuranceForm=this.fb.group({insuranceCode:[""],insuranceName:["",[S.required,S.minLength(4)]],sumInsured:[0,[S.required,S.min(20)]],insuranceCost:[0,[S.required,S.min(30)]]}),this.data.type=="edit"?this.typeForm="Editar":this.typeForm="Agregar";let e=this.insuranceService.getInsuranceByCode(this.data.insuranceCode);this.data.type=="edit"&&this.insuranceForm.setValue(e)}onSubmit(){this.insuranceForm.valid&&(this.data.type=="edit"?this.editInsurance():this.addNewInsurance())}editInsurance(){try{this.insuranceService.editInsurance(this.insuranceForm.value),this.closeForm(),this.alertService.showAlertSuccesMessage("editado")}catch{this.alertService.showAlertErrorMessage("editar")}}addNewInsurance(){try{let e="insu-"+se().substring(0,4),{insuranceName:a,sumInsured:n,insuranceCost:c}=this.insuranceForm.value,C={insuranceCode:e,insuranceName:a,sumInsured:n,insuranceCost:c};this.insuranceService.addInsurance(C),this.closeForm(),this.alertService.showAlertSuccesMessage("agregado")}catch{this.alertService.showAlertErrorMessage("agregar")}}cleanForm(){this.insuranceForm.reset()}closeForm(){this.dialogRef.close()}verifyFormErrors(e){return!!(this.insuranceForm.get(e)?.touched&&this.insuranceForm.get(e)?.invalid)}showFormAlertMessage(e){let a=this.insuranceForm.get(e);if(!a)return"";let n=a.errors,c={required:"Este campo es obligatorio",minlength:`El m\xEDnimo de caracteres es ${n?.minlength?.requiredLength}`,maxlength:`El m\xE1ximo de caracteres es ${n?.maxlength?.requiredLength}`,min:`El valor debe ser mayor a ${n?.min?.min}`};for(let C in a.errors)return a.errors.hasOwnProperty(C)?c[C]||"Error desconocido":""}static{this.\u0275fac=function(a){return new(a||r)(g(ne),g(E),g(V))}}static{this.\u0275cmp=_({type:r,selectors:[["app-insurance-modal"]],standalone:!0,features:[h],decls:29,vars:7,consts:[[1,"relative","py-4"],[1,"absolute","right-0","mr-4","hover:text-red-800",3,"click"],[1,"px-8"],[1,"text-2xl"],[1,"grid","grid-cols-2","gap-4","mt-5",3,"ngSubmit","formGroup"],[1,"col-span-2","md:col-span-1","lg:col-span-1"],["for","insuranceName",1,"block"],["type","text","formControlName","insuranceName","placeholder","Seguro Premium",1,"border-2","px-2","py-2","w-full","rounded-lg"],[1,"text-red-500","text-xs"],["for","sumInsured",1,"block"],["type","text","formControlName","sumInsured","placeholder","1000",1,"border-2","px-2","py-2","w-full","rounded-lg"],["for","insuranceCost",1,"block"],["type","text","formControlName","insuranceCost","placeholder","300",1,"border-2","px-2","py-2","w-full","rounded-lg"],[1,"relative","col-span-2"],[1,"absolute","right-0","flex"],["type","submit",1,"bg-cyan-900","text-white","flex","items-center","justify-center","px-4","py-2","my-4","w-fit","rounded-lg","mr-2"],["type","button",1,"bg-slate-800","text-white","flex","items-center","justify-center","px-4","py-2","my-4","w-fit","rounded-lg",3,"click"],["for","insuranceCode",1,"block"],["type","text","formControlName","insuranceCode","placeholder","insu4","readonly","",1,"border-2","px-2","py-2","w-full","rounded-lg"],[1,"mr-2"]],template:function(a,n){a&1&&(t(0,"div",0)(1,"mat-icon",1),l("click",function(){return n.closeForm()}),o(2," close "),i()(),t(3,"div",2)(4,"p",3),o(5),i(),f(6,"hr"),t(7,"form",4),l("ngSubmit",function(){return n.onSubmit()}),d(8,ve,4,0,"div",5),t(9,"div",5)(10,"label",6),o(11,"Nombre seguro"),i(),f(12,"input",7),d(13,Ie,2,1,"span",8),i(),t(14,"div",5)(15,"label",9),o(16,"Suma asegurada"),i(),f(17,"input",10),d(18,be,2,1,"span",8),i(),t(19,"div",5)(20,"label",11),o(21,"Prima"),i(),f(22,"input",12),d(23,Se,2,1,"span",8),i(),t(24,"div",13)(25,"div",14),d(26,ye,5,0,"button",15),t(27,"button",16),l("click",function(){return n.closeForm()}),o(28," Cancelar "),i()()()()()),a&2&&(s(5),P("",n.typeForm," Seguro"),s(2),y("formGroup",n.insuranceForm),s(),u(8,n.typeForm==="Editar"?8:-1),s(5),u(13,n.verifyFormErrors("insuranceName")?13:-1),s(5),u(18,n.verifyFormErrors("sumInsured")?18:-1),s(5),u(23,n.verifyFormErrors("insuranceCost")?23:-1),s(3),u(26,n.insuranceForm.valid?26:-1))},dependencies:[w,M,re,U,k,D,K,Y,Z]})}}return r})();function Me(r,p){if(r&1){let e=T();t(0,"tr",6)(1,"td",8)(2,"mat-icon",9),l("click",function(){let n=I(e).$implicit,c=m(2);return b(c.editInsurance(n.insuranceCode))}),o(3," edit "),i(),t(4,"mat-icon",10),l("click",function(){let n=I(e).$implicit,c=m(2);return b(c.deleteInsurance(n.insuranceCode))}),o(5," delete "),i()(),t(6,"td",8),o(7),i(),t(8,"td",8),o(9),i(),t(10,"td",8),o(11),R(12,"currency"),i(),t(13,"td",8),o(14),R(15,"currency"),i()()}if(r&2){let e=p.$implicit;s(7),x(e.insuranceCode),s(2),x(e.insuranceName),s(2),x(L(12,4,e.sumInsured)),s(3),x(L(15,6,e.insuranceCost))}}function we(r,p){if(r&1){let e=T();t(0,"button",14),l("click",function(){I(e);let n=m(3);return b(n.changePage(n.currentPage-1))}),t(1,"mat-icon"),o(2," chevron_left "),i()()}if(r&2){let e=m(3);y("disabled",e.currentPage===1)}}function Ee(r,p){if(r&1){let e=T();t(0,"div",7),d(1,we,3,1,"button",11),t(2,"span"),o(3,"P\xE1gina "),i(),t(4,"input",12),H("ngModelChange",function(n){I(e);let c=m(2);return $(c.currentPage,n)||(c.currentPage=n),b(n)}),l("change",function(){I(e);let n=m(2);return b(n.changePage(n.currentPage))}),i(),t(5,"span"),o(6),i(),t(7,"button",13),l("click",function(){I(e);let n=m(2);return b(n.changePage(n.currentPage+1))}),t(8,"mat-icon"),o(9," chevron_right "),i()()()}if(r&2){let e=m(2);s(),u(1,e.currentPage>1?1:-1),s(3),O("ngModel",e.currentPage),y("min",1)("max",e.totalPages),s(2),P(" de ",e.totalPages,""),s(),y("disabled",e.currentPage===e.totalPages)}}function Fe(r,p){if(r&1&&(t(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr",3)(4,"td",4),o(5,"Acciones"),i(),t(6,"td",4),o(7,"Id"),i(),t(8,"td",4),o(9,"Nombre seguro"),i(),t(10,"td",4),o(11,"Suma asegurada"),i(),t(12,"td",4),o(13,"Prima"),i()()(),t(14,"tbody",5),G(15,Me,16,8,"tr",6,B),i()()(),d(17,Ee,10,6,"div",7)),r&2){let e=m();s(15),W(e.getPageData()),s(2),u(17,e.totalPages>=1?17:-1)}}var me=(()=>{class r{constructor(e,a){this.insurancesService=e,this.alertService=a,this.dialog=v(A)}ngOnInit(){this.getListInsurance(),this.itemsPerPage=5,this.currentPage=1,this.totalPages=Math.ceil(this.insurances.length/this.itemsPerPage)}getListInsurance(){this.insurances=this.insurancesService.getInsurances()}deleteInsurance(e){try{this.insurancesService.deleteInsurance(e),this.getListInsurance(),this.alertService.showAlertSuccesMessage("eliminado")}catch{this.alertService.showAlertErrorMessage("eliminar")}}editInsurance(e){this.dialog.open(j,{data:{type:"edit",insuranceCode:e},width:"700px",maxWidth:"800px",height:"55%"}).afterClosed().subscribe(n=>{})}getPageData(){let e=(this.currentPage-1)*this.itemsPerPage,a=this.currentPage*this.itemsPerPage;return this.insurances.slice(e,a)}changePage(e){e>=1&&e<=this.totalPages?this.currentPage=e:this.currentPage=1}static{this.\u0275fac=function(a){return new(a||r)(g(E),g(V))}}static{this.\u0275cmp=_({type:r,selectors:[["app-insurances-table"]],standalone:!0,features:[h],decls:1,vars:1,consts:[[1,"overflow-x-auto","max-w-full"],[1,"w-full","table-auto"],[1,"bg-cyan-900","text-white","text-center"],[1,"poppins-regular"],[1,"p-2"],[1,"poppins-light","text-center"],[1,"border-b-2"],[1,"text-right","bg-slate-50","py-2","border-t-2","border-cyan-900","px-2","flex","justify-end","items-center","w-full"],[1,"px-4","py-2"],[1,"mr-4","text-blue-900","cursor-pointer",3,"click"],[1,"text-red-900","cursor-pointer","mr-4",3,"click"],[1,"pr-4","flex","items-center",3,"disabled"],["type","number",1,"rounded-lg","border-2","size-8","text-center",3,"ngModelChange","change","ngModel","min","max"],[1,"pl-4","flex","items-center",3,"click","disabled"],[1,"pr-4","flex","items-center",3,"click","disabled"]],template:function(a,n){a&1&&d(0,Fe,18,1),a&2&&u(0,n.insurances.length>=0?0:-1)},dependencies:[w,M,N,J,z,ie,k,X,D,te,ee,Q]})}}return r})();var de=(()=>{class r{constructor(e){this.insurancesService=e}addMassiveInsurances(e){this.insurancesService.addInsurance(e)}readTxt(e){let a=e.target.files[0];if(a){let n=new FileReader;n.onload=c=>{c.target.result.split(`
`).forEach((ue,Pe)=>{let F=ue.split(",");if(F.length===4){let pe=F[0],ge=F[1],fe=F[2],xe=F[3],_e={insuranceCode:pe,insuranceName:ge,sumInsured:fe,insuranceCost:xe};this.addMassiveInsurances(_e)}})},n.readAsText(a)}}static{this.\u0275fac=function(a){return new(a||r)(g(E))}}static{this.\u0275cmp=_({type:r,selectors:[["app-mass-loading-insurances"]],standalone:!0,features:[h],decls:6,vars:0,consts:[["for","fileInsurances",1,"block","poppins-regular","mb-2"],["type","file",1,"block","w-fit","text-sm","text-gray-900","border","border-gray-300","rounded-lg","cursor-pointer","bg-gray-50",3,"change"],[1,"text-xs","text-slate-500","px-2"]],template:function(a,n){a&1&&(t(0,"div")(1,"label",0),o(2,"Carga masiva de seguros: "),i(),t(3,"input",1),l("change",function(C){return n.readTxt(C)}),i(),t(4,"p",2),o(5,"Formato permitido: .txt"),i()())}})}}return r})();var tt=(()=>{class r{constructor(){this.dialog=v(A)}addInsurance(){this.dialog.open(j,{data:{type:"add"},width:"700px",maxWidth:"800px",height:"55%"}).afterClosed().subscribe(a=>{console.log("modal cerrado")})}static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275cmp=_({type:r,selectors:[["app-insurances"]],standalone:!0,features:[h],decls:12,vars:0,consts:[[1,"p-2"],[1,"flex","items-center"],[1,"text-3xl","mr-2"],[1,"flex","items-center","justify-center","px-4","py-2","bg-cyan-900","text-white","w-fit","rounded-lg",3,"click"],[1,"pt-8"],[1,"my-8"]],template:function(a,n){a&1&&(t(0,"div",0)(1,"div",1)(2,"span",2),o(3,"Seguros"),i(),t(4,"span",3),l("click",function(){return n.addInsurance()}),t(5,"mat-icon"),o(6," add "),i(),o(7," Agregar "),i()(),t(8,"div",4),f(9,"app-mass-loading-insurances"),i(),t(10,"div",5),f(11,"app-insurances-table"),i()())},dependencies:[N,w,M,me,de]})}}return r})();export{tt as InsurancesComponent};
